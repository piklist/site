{"id":1036,"date":"2013-02-15T09:34:29","date_gmt":"2013-02-15T14:34:29","guid":{"rendered":"http:\/\/piklist.com\/?p=1036"},"modified":"2019-09-30T16:12:57","modified_gmt":"2019-09-30T20:12:57","slug":"a-piklist-update-and-piklist-updates","status":"publish","type":"post","link":"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/","title":{"rendered":"A Piklist update, and Piklist Updates"},"content":{"rendered":"<p>First, a Piklist update. It&#8217;s been over two months since our last release, which is just way too long. We promise to try harder to do more frequent releases. \u00a0The good news is that Kevin and I have been working on many new Piklist features. \u00a0The bad news, is that they are only 90% ready for prime time. Once completed, we will have a seriously major version to release. \u00a0This version should address many of the issues and feature requests you&#8217;ve been asking for.<\/p>\n<p>While building this out we came across a major Piklist bug&#8230; Piklist didn&#8217;t really play nice with multisite. If you install on one site in a multisite install, all is well. But Network Activate, and bad things happen. Piklist wants to create two tables, but on Network Activation they were only created on the main site. Obviously, we needed to fix this, and also make it easy to implement for future updates. So, today we released v0.7.2, which contains the new Piklist Updates feature.<\/p>\n<h2>Piklist Updates<\/h2>\n<p>Writing update code for your WordPress plugin is not fun. Seriously, it&#8217;s just not fun. First, you need to determine if it&#8217;s an update or new install, and then you need to determine if multisite is running. If so, and the user network activated your plugin, then you need to loop through all the sites and run your update script. Yuck.<\/p>\n<p>Back in October 2010, Nacin announced that <a href=\"http:\/\/make.wordpress.org\/core\/2010\/10\/27\/plugin-activation-hooks-no-longer-fire-for-updates\/\">plugin activation hooks will no longer fire for updates<\/a>, and WordPress doesn&#8217;t have a register_update_hook(). When this was proposed in\u00a0<a href=\"http:\/\/core.trac.wordpress.org\/ticket\/14912\">trac ticket 14912<\/a>, it was declined by the core team. Further discussion led to this recommended procedure: store the plugin version in your database and verify it on each admin page load.<\/p>\n<p>Well, fear not my friends, Piklist will now do all the hard work for you and make it dead simple to create update routines for your Piklist plugins.<\/p>\n<ol>\n<li>First, create an &#8220;updates&#8221; folder in your piklist\/parts\/ folder.<\/li>\n<li>Then, create a file to contain your update procedure. The file name should be the version of your plugin.<\/li>\n<li>And of course, make sure you have a version number in the comment block of your PIklist plugin.<\/li>\n<\/ol>\n<p>That&#8217;s all folks! \u00a0Seriously, that&#8217;s it.<\/p>\n<p>So, how does it work? \u00a0Let&#8217;s use v0.7.2 of Piklist as an example.<\/p>\n<p>In the parts\/updates\/ folder lives a file named 0.7.2.php (same as the current version). This file contains the update routine for users updating from an earlier version to v0.7.2. This file is written to update ONE site by migrating some table data and deleting an old table. There is no multisite logic here&#8230;Piklist will handle that for you.<\/p>\n<p>Since there is no hook that fires when a plugin is updated, Piklist will only check for updates:<\/p>\n<ul>\n<li>When the logged in user can manage_options. Since\u00a0Administrators are the only users who can activate plugins, they should be the only users who can trigger an update as well.<\/li>\n<li>On the Plugins, Update and Dashboard pages.<\/li>\n<\/ul>\n<p>In addition to running the update, Piklist will keep track of each Piklist plugin you install. Not just the most recent version&#8230;but, a version history. Sweet!<\/p>\n<p>There are three caveats when writing your update procedure:<\/p>\n<ol>\n<li><strong>Write for ONE site:<\/strong>\u00a0The update procedure should be written as if you are updating a single site install. Piklist will automatically handle multisite updates for you. If you are manipulating tables, it is recommended that you use the\u00a0<a href=\"http:\/\/codex.wordpress.org\/Class_Reference\/wpdb\">wpdb class<\/a>, and $prefix to properly handle tables in a multisite install.<\/li>\n<li><strong>Only PHP:<\/strong>\u00a0The updates file can only contain PHP code.<\/li>\n<li><strong>Don&#8217;t define functions<\/strong>: Since an update procedure is designed to only run once per site, defining functions in your update procedure doesn&#8217;t make sense. Any functions should be defined in your main plugin code. You can call functions from your update procedure, just don&#8217;t define any.<\/li>\n<\/ol>\n<h2>Better Multisite Support<\/h2>\n<p>This is also the first step for better multisite support for Piklist. The new\u00a0check_network_propagate() function (in class-piklist.php)\u00a0will allow us to easily expand the multisite\u00a0capabilities\u00a0of Piklist and all Piklist plugins. \u00a0This has been a popular request, and you will start to see more multisite features roll out in the future.<\/p>\n<p>This isn&#8217;t quite the super awesome, feature packed update you deserve after two months, but it is a\u00a0necessary\u00a0update for what&#8217;s coming next.<\/p>\n<p>Keep sending us your Piklist success stories. \u00a0We love hearing from you!<\/p>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>First, a Piklist update. It&#8217;s been over two months since our last release, which is just way too long. We promise to try harder to do more frequent releases. \u00a0The good news is that Kevin and I have been working on many new Piklist features. \u00a0<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[1],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v15.9.2 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"A Piklist update, and Piklist Updates &bull; Piklist\" \/>\n<meta property=\"og:description\" content=\"First, a Piklist update. It&#039;s been over two months since our last release, which is just way too long. We promise to try harder to do more frequent releases. \u00a0The good news is that Kevin and I have been working on many new Piklist features. \u00a0\" \/>\n<meta property=\"og:url\" content=\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/\" \/>\n<meta property=\"og:site_name\" content=\"Piklist\" \/>\n<meta property=\"article:published_time\" content=\"2013-02-15T14:34:29+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2019-09-30T20:12:57+00:00\" \/>\n<meta name=\"twitter:label1\" content=\"Est. reading time\">\n\t<meta name=\"twitter:data1\" content=\"4 minutes\">\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Organization\",\"@id\":\"https:\/\/piklist.com\/#organization\",\"name\":\"Piklist\",\"url\":\"https:\/\/piklist.com\/\",\"sameAs\":[],\"logo\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/piklist.com\/#logo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/piklist.com\/wp-content\/uploads\/2015\/03\/facebook-profile.jpg\",\"width\":320,\"height\":320,\"caption\":\"Piklist\"},\"image\":{\"@id\":\"https:\/\/piklist.com\/#logo\"}},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/piklist.com\/#website\",\"url\":\"https:\/\/piklist.com\/\",\"name\":\"Piklist\",\"description\":\"Build Powerful Websites with WordPress\",\"publisher\":{\"@id\":\"https:\/\/piklist.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":\"https:\/\/piklist.com\/?s={search_term_string}\",\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/#webpage\",\"url\":\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/\",\"name\":\"A Piklist update, and Piklist Updates &bull; Piklist\",\"isPartOf\":{\"@id\":\"https:\/\/piklist.com\/#website\"},\"datePublished\":\"2013-02-15T14:34:29+00:00\",\"dateModified\":\"2019-09-30T20:12:57+00:00\",\"breadcrumb\":{\"@id\":\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"item\":{\"@type\":\"WebPage\",\"@id\":\"https:\/\/piklist.com\/\",\"url\":\"https:\/\/piklist.com\/\",\"name\":\"Home\"}},{\"@type\":\"ListItem\",\"position\":2,\"item\":{\"@type\":\"WebPage\",\"@id\":\"http:\/\/piklist.com\/category\/news\/\",\"url\":\"http:\/\/piklist.com\/category\/news\/\",\"name\":\"News\"}},{\"@type\":\"ListItem\",\"position\":3,\"item\":{\"@type\":\"WebPage\",\"@id\":\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/\",\"url\":\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/\",\"name\":\"A Piklist update, and Piklist Updates\"}}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/#webpage\"},\"author\":{\"@id\":\"https:\/\/piklist.com\/#\/schema\/person\/572c3fb52b0d3a658332b6a5b631d012\"},\"headline\":\"A Piklist update, and Piklist Updates\",\"datePublished\":\"2013-02-15T14:34:29+00:00\",\"dateModified\":\"2019-09-30T20:12:57+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/#webpage\"},\"commentCount\":7,\"publisher\":{\"@id\":\"https:\/\/piklist.com\/#organization\"},\"articleSection\":\"News\",\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"CommentAction\",\"name\":\"Comment\",\"target\":[\"https:\/\/piklist.com\/2013\/02\/15\/a-piklist-update-and-piklist-updates\/#respond\"]}]},{\"@type\":\"Person\",\"@id\":\"https:\/\/piklist.com\/#\/schema\/person\/572c3fb52b0d3a658332b6a5b631d012\",\"name\":\"Steve\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/piklist.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/d5e220c24cfed7817a39a8f4d577663e?s=96&d=wavatar&r=g\",\"caption\":\"Steve\"},\"sameAs\":[\"https:\/\/piklist.com\"]}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","_links":{"self":[{"href":"https:\/\/piklist.com\/wp-json\/wp\/v2\/posts\/1036"}],"collection":[{"href":"https:\/\/piklist.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/piklist.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/piklist.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/piklist.com\/wp-json\/wp\/v2\/comments?post=1036"}],"version-history":[{"count":0,"href":"https:\/\/piklist.com\/wp-json\/wp\/v2\/posts\/1036\/revisions"}],"wp:attachment":[{"href":"https:\/\/piklist.com\/wp-json\/wp\/v2\/media?parent=1036"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/piklist.com\/wp-json\/wp\/v2\/categories?post=1036"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/piklist.com\/wp-json\/wp\/v2\/tags?post=1036"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}